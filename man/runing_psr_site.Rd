% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runing_psr_site.R
\name{runing_psr_site}
\alias{runing_psr_site}
\title{Run PSR Method for Identifying Weather Cues at a Specific Site}
\usage{
runing_psr_site(
  bio_data = bio_data,
  site = site,
  climate_csv = climate_csv,
  lastdays = 600,
  refday = 305,
  rollwin = 1,
  covariates.of.interest = "TMEAN",
  myform.fin = formula("log.seed ~ TMEAN"),
  matrice = c(3, 1),
  knots = NULL,
  tolerancedays = 7,
  yearneed = 2
)
}
\arguments{
\item{bio_data}{A data frame containing biological data with columns such as \code{Year}, \code{plotname.lon.lat}, and \code{log.seed}.}

\item{site}{A string representing the site name, which should match the \code{plotname.lon.lat} in \code{bio_data}.}

\item{lastdays}{Integer specifying the total number of days to include in the analysis (default is 600).}

\item{refday}{Integer representing the reference day (default is 305). This is the day from which the climate data is tracked backward.}

\item{rollwin}{Integer representing the size of the rolling window for calculating the rolling averages (default is 1).}

\item{covariates.of.interest}{A string indicating the climate variable of interest (e.g., 'TMEAN', 'TMAX', 'TMIN', 'PRP') (default is 'TMEAN').}

\item{matrice}{A numeric vector of length 2 indicating the penalties to apply in the smoothing function of the model (default is \code{c(3,1)}).}

\item{knots}{Integer specifying the number of knots for the GAM model. If \code{NULL} (default), the function will set the knots to \code{ny - 1}, where \code{ny} is the number of years of data.}

\item{tolerancedays}{Integer specifying the tolerance (in days) for identifying consecutive periods (default is 7).}

\item{climate.path}{A string representing the path to the climate data files (e.g., daily temperature data).}

\item{plot}{Logical indicating whether to plot the partial effect of the model (default is \code{TRUE}).}
}
\value{
A data frame summarizing the significant windows identified by the model. If no significant windows are found, the function returns a data frame with \code{NA} values.
}
\description{
This function performs the PSR (Penalized Spline Regression) method to identify weather cues for biological data, based on the methodology from Roberts et al., and adapted from Simmonds et al.
The function uses climate data and site-specific biological data to model the effect of temperature (or other climate variables) on a response variable (e.g., seed production).
}
\details{
The function processes climate data, calculates rolling averages of climate variables, and fits a generalized additive model (GAM) to the biological data. It identifies periods of significant climate effects based on the model's output.

The function checks for significant temperature cues by calculating upper and lower limits (mean Â± 1.96 * SD) and identifies time windows where the model exceeds these thresholds.
}
\examples{
\dontrun{
# Example usage:
bio_data <- your_biological_data
site <- "site_name"
climate_path <- "path_to_climate_data/"
result <- runing_psr_site(bio_data = bio_data, 
                          site = site, 
                          climate.path = climate_path, 
                          lastdays = 600, 
                          refday = 305, 
                          rollwin = 1, 
                          covariates.of.interest = 'TMEAN',
                          matrice = c(3,1), 
                          knots = NULL, 
                          tolerancedays = 7, 
                          plot = TRUE)
}

}
\seealso{
\code{\link[mgcv]{gam}}
}
