% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{reruning_windows_modelling}
\alias{reruning_windows_modelling}
\title{Re-run climate windows modeling for a specified sequence}
\usage{
reruning_windows_modelling(
  z,
  tible.sitelevel = tible.sitelevel,
  window_ranges_df = window_ranges_df,
  rolling.temperature.data = rolling.temperature.data,
  myform.fin = formula("log.seed ~ mean.temperature"),
  refday = 305,
  rollwin = 1
)
}
\arguments{
\item{z}{Integer. The index representing the row number in the \code{window_ranges_df} data frame, which contains the window ranges for analysis.}

\item{tible.sitelevel}{Data frame. The biological site-level data, which contains
seed production and other relevant variables for modeling. Default is \code{tible.sitelevel}.}

\item{rolling.temperature.data}{Data frame. The climate data containing
rolling temperature averages and other climate variables. Default is \code{rolling.temperature.data}.}
}
\value{
A data frame containing the model results, which include:
\itemize{
\item \code{sitenewname}: The name of the biological site.
\item \code{plotname.lon.lat}: The plot name and its longitude/latitude.
\item \code{reference.day}: The day used as the reference point for windowing.
\item \code{windows.size}: The size of the window in days.
\item \code{window.open}: Start of the window period (days before the reference day).
\item \code{window.close}: End of the window period (days before the reference day).
\item \code{intercept}: The intercept of the fitted linear model.
\item \code{intercept.se}: Standard error of the intercept.
\item \code{estimate}: The coefficient estimate for the temperature variable in the model.
\item \code{estimate.se}: Standard error of the coefficient estimate.
\item \code{pvalue}: P-value for the temperature coefficient.
\item \code{r2}: R-squared value of the model.
\item \code{AIC}: Akaike Information Criterion for the model.
\item \code{nobs}: Number of observations used in the model.
\item \code{nsequence.id}: The index corresponding to the window range used.
}
}
\description{
This function re-runs climate windows modeling for a given index \code{z}, extracting
window ranges, filtering rolling temperature data, and merging it with biological
site-level data to fit a linear model (\code{lm}) using a predefined formula.
}
\details{
The function:
\enumerate{
\item Extracts the \code{window.open} and \code{window.close} values from the \code{window_ranges_df}
for the specified index \code{z}.
\item Filters \code{rolling.temperature.data} to retrieve climate data within the window range.
\item Aggregates temperature data (mean temperature) for each combination of \code{LONGITUDE},
\code{LATITUDE}, and \code{year}.
\item Joins the filtered climate data with biological site-level data (\code{tible.sitelevel}).
\item Fits a linear model (\code{lm}) using the combined data and the predefined formula \code{myform.fin}.
\item Returns a data frame with the model's coefficients, standard errors, p-values, R-squared, AIC,
number of observations, and sequence ID.
}
}
\examples{
# Assuming window_ranges_df, rolling.temperature.data, and tible.sitelevel are defined:
result <- reruning_windows_modelling(1, tible.sitelevel = tible.sitelevel, rolling.temperature.data = rolling.temperature.data)
print(result)

}
