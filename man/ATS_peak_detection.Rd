% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ATS_peak_detection.R
\name{ATS_peak_detection}
\alias{ATS_peak_detection}
\title{Perform Peak signal detection Analysis Across all Time Series (ATS)}
\usage{
ATS_peak_detection(
  Results_days,
  siteforsub,
  bio_data_all,
  climate.path,
  refday,
  lastdays,
  rollwin,
  lag,
  threshold
)
}
\arguments{
\item{Results_days}{A data frame containing daily results from prior CSP analysis. Must include columns \code{estimate} (slope) and \code{r.squared}.}

\item{siteforsub}{Character. Site identifier, typically formatted as \code{longitude=..._latitude=...}, used to match \code{bio_data_all}.}

\item{bio_data_all}{A data frame of biological data across multiple sites. Must include \code{plotname.lon.lat}, \code{sitenewname}, \code{log.seed}, and \code{Year}.}

\item{climate.path}{Character. File path to the folder containing site-specific climate \code{.qs} files.}

\item{refday}{Integer. Day of year used as the reference point for backwards windowing. Default is 305 (November 1).}

\item{lastdays}{Integer. Number of days before \code{refday} to include in the analysis window. Default is 600.}

\item{rollwin}{Integer. Size of the rolling window to apply to climate data (in days). Default is 1 (no smoothing).}

\item{lag}{Integer. Number of past days used in rolling mean/std for the thresholding algorithm.}

\item{threshold}{Numeric. Threshold in standard deviations to classify a signal as a peak.}
}
\value{
A data frame summarizing all identified weather cue windows and their corresponding model results (e.g., slope, R², RMSE). If no window is detected, a message is returned instead.
}
\description{
This function performs peak signal detection on climate and seed production data for a specific site
using the CSP-derived slope and R² values. The function identifies strong signal periods (weather cue windows)
by detecting peaks in the product of slope and R² using a thresholding algorithm. It then evaluates those periods
using linear models.
}
\details{
This function:
\itemize{
\item Filters the biological dataset for a specific site using \code{siteforsub}.
\item Loads climate data for the matching site using \code{format_climate_data()}.
\item Applies \code{runing_peak_detection()} to identify windows with strong signal (high slope × R² product).
\item Evaluates each identified window using regression and returns performance summaries.
}

The internal peak detection algorithm uses a moving z-score filter to identify signal periods that exceed
a given number of standard deviations above the mean.
}
\examples{
\dontrun{
cues_summary <- ATS_peak_detection(
  Results_days = Results_CSP[["longitude=3.5_latitude=44.1"]],
  siteforsub = "longitude=3.5_latitude=44.1",
  bio_data_all = Fagus.seed,
  climate.path = "data/climate/",
  refday = 305,
  lastdays = 600,
  rollwin = 1,
  lag = 100,
  threshold = 3
)
}

}
\seealso{
\code{\link{runing_peak_detection}}, \code{\link{Thresholding_algorithm}}, \code{\link{save_window_ranges}}
}
