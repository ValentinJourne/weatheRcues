% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runing_climwin.R
\name{runing_climwin}
\alias{runing_climwin}
\title{Run Climate Window Analysis (based on \code{climwin})}
\usage{
runing_climwin(
  ...,
  climate_data,
  bio_data,
  site.name,
  range = c(600, 0),
  cinterval = "day",
  refday = c(1, 11),
  optionwindows = "absolute",
  climate_var = "TMEAN",
  stat.aggregate = "mean",
  formulanull = stats::formula("log.seed ~ 1"),
  fun = "lin",
  cmissing = "method2",
  give.clean = TRUE
)
}
\arguments{
\item{climate_data}{A data frame or tibble containing climate data. Must include a \code{date} column and a column matching the name provided in \code{climate_var} (e.g., \code{"TMEAN"}).}

\item{bio_data}{A data frame or tibble containing biological data, including a \code{Date2} column (date of biological observation) and the response variable used in \code{formulanull}.}

\item{site.name}{A character string used to label the output (e.g., the name or ID of the site being analyzed).}

\item{range}{A numeric vector of length two indicating the maximum and minimum time before the reference date (in days) over which to search for climate windows. Default is \code{c(600, 0)}.}

\item{cinterval}{The interval over which to aggregate the climate variable. Options include \code{"day"}, \code{"week"}, etc. Default is \code{"day"}.}

\item{refday}{Either a numeric DOY (e.g., \code{305} for November 1) or a vector of day and month (e.g., \code{c(1, 11)} for November 1). This sets the reference date for \code{absolute} windows.}

\item{optionwindows}{One of \code{"absolute"} or \code{"relative"}. \code{"absolute"} windows are fixed in time (e.g., fixed season), while \code{"relative"} windows move with the biological event. Default is \code{"absolute"}.}

\item{climate_var}{Name of the column in \code{climate_data} containing the climate variable of interest (e.g., \code{"TMEAN"}). Default is \code{"TMEAN"}.}

\item{stat.aggregate}{Aggregation function to apply within the window. One of \code{"mean"}, \code{"sum"}, \code{"min"}, or \code{"max"}. Default is \code{"mean"}.}

\item{formulanull}{A formula specifying the null model (e.g., \code{log.seed ~ 1}). Must match a column in \code{bio_data}. Default is \code{log.seed ~ 1}.}

\item{fun}{Functional form used to test the climate effect. Common values are \code{"lin"} (linear), \code{"quad"} (quadratic), etc. Default is \code{"lin"}.}

\item{cmissing}{Method for handling missing climate data. See \code{climwin::slidingwin()} documentation. Default is \code{"method2"}.}

\item{give.clean}{Logical. If \code{TRUE}, returns a cleaned summary of results including slope, intercept, RÂ², AIC, and window bounds. If \code{FALSE}, returns the full output from \code{climwin::slidingwin()}. Default is \code{TRUE}.}
}
\value{
A data frame containing the best-fit window statistics:
\itemize{
\item \code{sitenewname}: Site label from \code{bio_data}
\item \code{climate.file}: Site name provided to \code{site.name}
\item \code{window.open}, \code{window.close}: Days before the reference date indicating the climate window
\item \code{r2}, \code{AIC}: Performance metrics for the best-fit model
\item \code{slope.estimate}, \code{intercept.estimate}: Coefficient summaries from the best-fit model
\item \code{sigma}: Model residual standard deviation
}
}
\description{
This function performs a climate window analysis using the \code{climwin} package to identify
the optimal climate window (i.e., period of influence) that best explains variations in a biological response variable,
typically seed production. The analysis uses a sliding window approach to correlate climate variables with biological observations.
}
\details{
This function is a wrapper around \code{climwin::slidingwin()} with additional input checks and a standardized output format.
It is intended for automated analysis across multiple sites or datasets. The \code{refday} input supports both numeric DOY and day-month vector formats.
}
\examples{
\dontrun{
result <- runing_climwin_site(
  climate_data = my_climate,
  bio_data = my_seeds,
  site.name = "site1"
)
}

}
