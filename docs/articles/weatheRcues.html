<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started • weatheRcues</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">weatheRcues</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/weatheRcues.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ValentinJourne/weatheRcues/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ValentinJourne/weatheRcues/blob/HEAD/vignettes/weatheRcues.Rmd" class="external-link"><code>vignettes/weatheRcues.Rmd</code></a></small>
      <div class="hidden name"><code>weatheRcues.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ValentinJourne/weatheRcues" class="external-link">weatheRcues</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.4     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: nlme</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'nlme'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     collapse</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This is mgcv 1.9-3. For overview type 'help("mgcv-package")'.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>weatheRcues</code> package helps detect biologically
relevant weather cue windows—specific periods where climate variables
(e.g., temperature, rainfall) best explain biological responses such as
seed production. Here we demonstrate how to apply four major
methods:</p>
<ol style="list-style-type: decimal">
<li><p>Sliding Time Window (climwin)</p></li>
<li><p>P-spline Regression</p></li>
<li><p>Climate Sensitivity Profile</p></li>
<li><p>Peak Signal Detection</p></li>
</ol>
<p>We will first simulate climate and seed data (because we all love
seed production and want to know more about plant mast seeding) to
illustrate each method.</p>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>We generate one weather cue window from June 150–160 (DOY) to
influence seed production.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  </span>
<span><span class="va">startyear</span> <span class="op">=</span> <span class="fl">1940</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="va">startyear</span><span class="op">:</span><span class="fl">2020</span></span>
<span><span class="va">days_per_year</span> <span class="op">&lt;-</span> <span class="fl">365</span></span>
<span></span>
<span><span class="co">#ok so now just generate climate for a long time.</span></span>
<span><span class="co">#I will add yday, but also, the way I coded the function (for now) you need to have LONGITUDE AND LATITUDE columns</span></span>
<span><span class="va">climate_data_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">startyear</span>,<span class="st">"-01-01"</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"day"</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">years</span><span class="op">)</span> <span class="op">*</span> <span class="va">days_per_year</span><span class="op">)</span>,</span>
<span>  temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">years</span><span class="op">)</span> <span class="op">*</span> <span class="va">days_per_year</span>, min <span class="op">=</span> <span class="fl">10</span>, max <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">date</span>, <span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    yday <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">yday</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>    LONGITUDE <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    LATITUDE <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Select ~ one week in June </span></span>
<span><span class="va">june_week</span> <span class="op">&lt;-</span> <span class="va">climate_data_simulated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">yday</span> <span class="op">&gt;=</span> <span class="fl">150</span> <span class="op">&amp;</span> <span class="va">yday</span> <span class="op">&lt;=</span> <span class="fl">160</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#now you can simulate you seed production (here I used parameters I observed). For seed production data, you also need to have additional column, Date2, with this d-m-Y format and two other column, plotname.lon.lat and sitenewname. I will try to fix this later, I used this to be sure my time series are matching climate location. I also selected one year less (to have sure that climate would be enough years) </span></span>
<span><span class="va">seed_production_simulated</span> <span class="op">&lt;-</span> <span class="va">june_week</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean_temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    log.seed <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">mean_temp</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,mean <span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    Date2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-06-15"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    sitenewname <span class="op">=</span> <span class="st">"test"</span>,</span>
<span>    plotname.lon.lat <span class="op">=</span> <span class="st">"test"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;</span> <span class="va">startyear</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sliding-time-window">Sliding Time Window<a class="anchor" aria-label="anchor" href="#sliding-time-window"></a>
</h2>
<p>For the first method, I was using climwin R package. Here I customize
a bit the function, but you can specify more option (for aggregate
weather window for example). Please refer to <em>Bailey and van de Pol,
2016, PlosOne, climwin: An R Toolbox for Climate Window
Analysis</em>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">seed_production_simulated</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;    year mean_temp log.seed Date2               sitenewname plotname.lon.lat</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>941   -<span style="color: #BB0000;">0.312</span>    -<span style="color: #BB0000;">5.33</span>  1941-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>942   -<span style="color: #BB0000;">0.054</span><span style="color: #BB0000; text-decoration: underline;">1</span>   -<span style="color: #BB0000;">0.648</span> 1942-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>943   -<span style="color: #BB0000;">0.237</span>    -<span style="color: #BB0000;">3.59</span>  1943-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">1</span>944    0.086<span style="text-decoration: underline;">0</span>    1.47  1944-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">1</span>945   -<span style="color: #BB0000;">0.343</span>    -<span style="color: #BB0000;">4.35</span>  1945-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">1</span>946    0.066<span style="text-decoration: underline;">9</span>    2.59  1946-06-15 <span style="color: #949494;">00:00:00</span> test        test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">climate_data_simulated</span><span class="op">)</span></span>
<span><span class="co">#&gt;         date       temp year yday LONGITUDE LATITUDE</span></span>
<span><span class="co">#&gt; 1 1940-01-01 -0.7300034 1940    1        NA       NA</span></span>
<span><span class="co">#&gt; 2 1940-01-02  1.0069975 1940    2        NA       NA</span></span>
<span><span class="co">#&gt; 3 1940-01-03 -0.3088745 1940    3        NA       NA</span></span>
<span><span class="co">#&gt; 4 1940-01-04  1.3355500 1940    4        NA       NA</span></span>
<span><span class="co">#&gt; 5 1940-01-05  1.5348410 1940    5        NA       NA</span></span>
<span><span class="co">#&gt; 6 1940-01-06 -1.5695631 1940    6        NA       NA</span></span>
<span></span>
<span><span class="va">climwin.output</span> <span class="op">=</span> <span class="fu"><a href="../reference/runing_climwin.html">runing_climwin</a></span><span class="op">(</span></span>
<span>        climate_data <span class="op">=</span> <span class="va">climate_data_simulated</span>,</span>
<span>        bio_data <span class="op">=</span> <span class="va">seed_production_simulated</span>,</span>
<span>        site.name <span class="op">=</span> <span class="st">'test'</span>,</span>
<span>        range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co">#double check if climate is long enough (to match bio data)</span></span>
<span>        cinterval <span class="op">=</span> <span class="st">'day'</span>,</span>
<span>        refday <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">01</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>        optionwindows <span class="op">=</span> <span class="st">'absolute'</span>,</span>
<span>        climate_var <span class="op">=</span> <span class="st">'temp'</span></span>
<span>      <span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Response variable: log.seed"</span></span>
<span><span class="co">#&gt; [1] "range: 200" "range: 0"  </span></span>
<span><span class="co">#&gt; [1] "cinterval: day"</span></span>
<span><span class="co">#&gt; [1] "ref day starting: 1 with month: 11"</span></span>
<span><span class="co">#&gt; [1] "stat aggregate: mean"</span></span>
<span><span class="co">#&gt; [1] "windows option: absolute"</span></span>
<span><span class="co">#&gt; [1] "variable of interest: temp"</span></span>
<span><span class="co">#&gt; Initialising, please wait...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              ||                                                                     |   1%  |                                                                              ||                                                                     |   2%  |                                                                              |||                                                                    |   2%  |                                                                              |||                                                                    |   3%  |                                                                              ||||                                                                   |   4%  |                                                                              ||||                                                                   |   5%  |                                                                              |||||                                                                  |   5%  |                                                                              |||||                                                                  |   6%  |                                                                              ||||||                                                                 |   7%  |                                                                              ||||||                                                                 |   8%  |                                                                              |||||||                                                                |   8%  |                                                                              |||||||                                                                |   9%  |                                                                              ||||||||                                                               |   9%  |                                                                              ||||||||                                                               |  10%  |                                                                              ||||||||                                                               |  11%  |                                                                              |||||||||                                                              |  11%  |                                                                              |||||||||                                                              |  12%  |                                                                              ||||||||||                                                             |  12%  |                                                                              ||||||||||                                                             |  13%  |                                                                              |||||||||||                                                            |  14%  |                                                                              |||||||||||                                                            |  15%  |                                                                              ||||||||||||                                                           |  15%  |                                                                              ||||||||||||                                                           |  16%  |                                                                              |||||||||||||                                                          |  17%  |                                                                              |||||||||||||                                                          |  18%  |                                                                              ||||||||||||||                                                         |  18%  |                                                                              ||||||||||||||                                                         |  19%  |                                                                              |||||||||||||||                                                        |  19%  |                                                                              |||||||||||||||                                                        |  20%  |                                                                              |||||||||||||||                                                        |  21%  |                                                                              ||||||||||||||||                                                       |  21%  |                                                                              ||||||||||||||||                                                       |  22%  |                                                                              |||||||||||||||||                                                      |  22%  |                                                                              |||||||||||||||||                                                      |  23%  |                                                                              ||||||||||||||||||                                                     |  24%  |                                                                              ||||||||||||||||||                                                     |  25%  |                                                                              |||||||||||||||||||                                                    |  25%  |                                                                              |||||||||||||||||||                                                    |  26%  |                                                                              ||||||||||||||||||||                                                   |  27%  |                                                                              |||||||||||||||||||||                                                  |  28%  |                                                                              |||||||||||||||||||||                                                  |  29%  |                                                                              ||||||||||||||||||||||                                                 |  30%  |                                                                              ||||||||||||||||||||||                                                 |  31%  |                                                                              |||||||||||||||||||||||                                                |  31%  |                                                                              |||||||||||||||||||||||                                                |  32%  |                                                                              ||||||||||||||||||||||||                                               |  32%  |                                                                              ||||||||||||||||||||||||                                               |  33%  |                                                                              |||||||||||||||||||||||||                                              |  34%  |                                                                              |||||||||||||||||||||||||                                              |  35%  |                                                                              ||||||||||||||||||||||||||                                             |  35%  |                                                                              ||||||||||||||||||||||||||                                             |  36%  |                                                                              |||||||||||||||||||||||||||                                            |  37%  |                                                                              |||||||||||||||||||||||||||                                            |  38%  |                                                                              ||||||||||||||||||||||||||||                                           |  38%  |                                                                              ||||||||||||||||||||||||||||                                           |  39%  |                                                                              |||||||||||||||||||||||||||||                                          |  39%  |                                                                              |||||||||||||||||||||||||||||                                          |  40%  |                                                                              |||||||||||||||||||||||||||||                                          |  41%  |                                                                              ||||||||||||||||||||||||||||||                                         |  41%  |                                                                              ||||||||||||||||||||||||||||||                                         |  42%  |                                                                              |||||||||||||||||||||||||||||||                                        |  43%  |                                                                              ||||||||||||||||||||||||||||||||                                       |  44%  |                                                                              ||||||||||||||||||||||||||||||||                                       |  45%  |                                                                              |||||||||||||||||||||||||||||||||                                      |  45%  |                                                                              |||||||||||||||||||||||||||||||||                                      |  46%  |                                                                              ||||||||||||||||||||||||||||||||||                                     |  47%  |                                                                              |||||||||||||||||||||||||||||||||||                                    |  48%  |                                                                              |||||||||||||||||||||||||||||||||||                                    |  49%  |                                                                              ||||||||||||||||||||||||||||||||||||                                   |  49%  |                                                                              ||||||||||||||||||||||||||||||||||||                                   |  50%  |                                                                              |||||||||||||||||||||||||||||||||||||                                  |  51%  |                                                                              |||||||||||||||||||||||||||||||||||||                                  |  52%  |                                                                              ||||||||||||||||||||||||||||||||||||||                                 |  53%  |                                                                              |||||||||||||||||||||||||||||||||||||||                                |  54%  |                                                                              ||||||||||||||||||||||||||||||||||||||||                               |  55%  |                                                                              ||||||||||||||||||||||||||||||||||||||||                               |  56%  |                                                                              |||||||||||||||||||||||||||||||||||||||||                              |  57%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||                             |  58%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||                             |  59%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||                            |  60%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||                           |  61%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||                           |  62%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||                          |  63%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||                         |  64%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||                        |  65%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||                        |  66%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||                       |  67%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||                      |  68%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||                      |  69%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||                     |  70%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||                    |  71%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||                    |  72%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||                   |  72%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||                   |  73%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||                  |  74%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||                  |  75%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||                 |  76%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||                |  77%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||                |  78%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||               |  78%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||              |  79%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||              |  80%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||             |  81%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||             |  82%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||            |  83%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||           |  84%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||           |  85%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||          |  86%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||         |  87%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||         |  88%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||        |  88%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||       |  89%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||       |  90%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||      |  91%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||     |  92%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||     |  93%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||    |  94%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||   |  95%  |                                                                              ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||   |  96%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||  |  97%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| |  98%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| |  99%  |                                                                              |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| 100%</span></span>
<span><span class="co">#&gt; Registered S3 methods overwritten by 'broom':</span></span>
<span><span class="co">#&gt;   method        from </span></span>
<span><span class="co">#&gt;   nobs.fitdistr MuMIn</span></span>
<span><span class="co">#&gt;   nobs.multinom MuMIn</span></span>
<span></span>
<span><span class="va">climwin.output</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 26</span></span></span>
<span><span class="co">#&gt;   sitenewname climate.file response climate          type  stat  func  DeltaAICc</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> test        test         log.seed temperature.deg… abso… mean  lin       -<span style="color: #BB0000;">204.</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 18 more variables: window.open &lt;int&gt;, window.close &lt;dbl&gt;, AIC &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AICc &lt;dbl&gt;, BIC &lt;dbl&gt;, r2 &lt;dbl&gt;, R2_adjusted &lt;dbl&gt;, RMSE &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Sigma &lt;dbl&gt;, slope.estimate &lt;dbl&gt;, slope.std.error &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   slope.statistic &lt;dbl&gt;, slope.p.value &lt;dbl&gt;, intercept.estimate &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   intercept.std.error &lt;dbl&gt;, intercept.statistic &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   intercept.p.value &lt;dbl&gt;, sigma &lt;dbl&gt;</span></span></span>
<span><span class="co">#in case you can change the option to give.clean = FALSE, it will give you all models outputs from `climwin::slidingwin`</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="p-spline-regression">P-Spline regression<a class="anchor" aria-label="anchor" href="#p-spline-regression"></a>
</h2>
<p>P-splines model day-specific weather effects and apply a penalty to
smooth consecutive coefficients. Here we got some issues, if data is too
noisy (which is often the case with seed production in trees) or too
short time series. But it is consider as one of the robust method if you
are using phenological datasets (see another application in <em>Simmonds
et al, Journal of Animal Ecology, 2019</em>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">seed_production_simulated</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;    year mean_temp log.seed Date2               sitenewname plotname.lon.lat</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>941   -<span style="color: #BB0000;">0.312</span>    -<span style="color: #BB0000;">5.33</span>  1941-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>942   -<span style="color: #BB0000;">0.054</span><span style="color: #BB0000; text-decoration: underline;">1</span>   -<span style="color: #BB0000;">0.648</span> 1942-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>943   -<span style="color: #BB0000;">0.237</span>    -<span style="color: #BB0000;">3.59</span>  1943-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">1</span>944    0.086<span style="text-decoration: underline;">0</span>    1.47  1944-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">1</span>945   -<span style="color: #BB0000;">0.343</span>    -<span style="color: #BB0000;">4.35</span>  1945-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">1</span>946    0.066<span style="text-decoration: underline;">9</span>    2.59  1946-06-15 <span style="color: #949494;">00:00:00</span> test        test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">climate_data_simulated</span><span class="op">)</span></span>
<span><span class="co">#&gt;         date       temp year yday LONGITUDE LATITUDE</span></span>
<span><span class="co">#&gt; 1 1940-01-01 -0.7300034 1940    1        NA       NA</span></span>
<span><span class="co">#&gt; 2 1940-01-02  1.0069975 1940    2        NA       NA</span></span>
<span><span class="co">#&gt; 3 1940-01-03 -0.3088745 1940    3        NA       NA</span></span>
<span><span class="co">#&gt; 4 1940-01-04  1.3355500 1940    4        NA       NA</span></span>
<span><span class="co">#&gt; 5 1940-01-05  1.5348410 1940    5        NA       NA</span></span>
<span><span class="co">#&gt; 6 1940-01-06 -1.5695631 1940    6        NA       NA</span></span>
<span></span>
<span><span class="va">pspline.output</span> <span class="op">=</span> <span class="fu"><a href="../reference/runing_psr.html">runing_psr</a></span><span class="op">(</span></span>
<span>  bio_data <span class="op">=</span> <span class="va">seed_production_simulated</span>,</span>
<span>  site <span class="op">=</span> <span class="st">'test'</span>,</span>
<span>  climate_data <span class="op">=</span> <span class="va">climate_data_simulated</span>,</span>
<span>  lastdays <span class="op">=</span> <span class="fl">170</span>,</span>
<span>  refday <span class="op">=</span> <span class="fl">305</span>,</span>
<span>  rollwin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  formula_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="st">'log.seed ~ temp'</span><span class="op">)</span>,</span>
<span>  matrice <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  knots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tolerancedays <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  yearneed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(year)`</span></span></code></pre></div>
<p><img src="weatheRcues_files/figure-html/PSR-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">pspline.output</span></span>
<span><span class="co">#&gt;   sitenewname plotname.lon.lat reference.day windows.size window.open</span></span>
<span><span class="co">#&gt; 1        test             test           305            1         155</span></span>
<span><span class="co">#&gt;   window.close intercept.estimate intercept.std.error slope.estimate</span></span>
<span><span class="co">#&gt; 1          147           1.010298           0.2752799       13.10497</span></span>
<span><span class="co">#&gt;   slope.std.error       pvalue        r2      AIC    sigma nobs nsequence.id</span></span>
<span><span class="co">#&gt; 1       0.7893469 2.541362e-27 0.7794343 375.1715 2.462168   80            1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="climate-sensitivity-profile">Climate Sensitivity Profile<a class="anchor" aria-label="anchor" href="#climate-sensitivity-profile"></a>
</h2>
<p>This method performs a daily regression, extracting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
and slope over time, and fits two GAMs to smooth the results. Cue
windows are defined by where both metrics exceed thresholds. First step
here is to run a daily relationship.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">seed_production_simulated</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;    year mean_temp log.seed Date2               sitenewname plotname.lon.lat</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>941   -<span style="color: #BB0000;">0.312</span>    -<span style="color: #BB0000;">5.33</span>  1941-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>942   -<span style="color: #BB0000;">0.054</span><span style="color: #BB0000; text-decoration: underline;">1</span>   -<span style="color: #BB0000;">0.648</span> 1942-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>943   -<span style="color: #BB0000;">0.237</span>    -<span style="color: #BB0000;">3.59</span>  1943-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">1</span>944    0.086<span style="text-decoration: underline;">0</span>    1.47  1944-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">1</span>945   -<span style="color: #BB0000;">0.343</span>    -<span style="color: #BB0000;">4.35</span>  1945-06-15 <span style="color: #949494;">00:00:00</span> test        test            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">1</span>946    0.066<span style="text-decoration: underline;">9</span>    2.59  1946-06-15 <span style="color: #949494;">00:00:00</span> test        test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">climate_data_simulated</span><span class="op">)</span></span>
<span><span class="co">#&gt;         date       temp year yday LONGITUDE LATITUDE</span></span>
<span><span class="co">#&gt; 1 1940-01-01 -0.7300034 1940    1        NA       NA</span></span>
<span><span class="co">#&gt; 2 1940-01-02  1.0069975 1940    2        NA       NA</span></span>
<span><span class="co">#&gt; 3 1940-01-03 -0.3088745 1940    3        NA       NA</span></span>
<span><span class="co">#&gt; 4 1940-01-04  1.3355500 1940    4        NA       NA</span></span>
<span><span class="co">#&gt; 5 1940-01-05  1.5348410 1940    5        NA       NA</span></span>
<span><span class="co">#&gt; 6 1940-01-06 -1.5695631 1940    6        NA       NA</span></span>
<span></span>
<span><span class="va">daily.relation.res</span> <span class="op">=</span> <span class="fu"><a href="../reference/runing_daily_relationship.html">runing_daily_relationship</a></span><span class="op">(</span></span>
<span>  bio_data <span class="op">=</span> <span class="va">seed_production_simulated</span>,</span>
<span>  climate_data <span class="op">=</span> <span class="va">climate_data_simulated</span>,</span>
<span>  lastdays <span class="op">=</span> <span class="fl">170</span>,</span>
<span>  refday <span class="op">=</span> <span class="fl">305</span>,</span>
<span>  rollwin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  formula_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="st">'log.seed ~ temp'</span><span class="op">)</span>,</span>
<span>  yearneed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(year)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(days.reversed)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(sitenewname, days.reversed)`</span></span>
<span></span>
<span></span>
<span><span class="co">#here you have a function to make a calendar matching DOY and days reversed. </span></span>
<span><span class="va">calendar</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_reverse_day_calendar.html">generate_reverse_day_calendar</a></span><span class="op">(</span>refday <span class="op">=</span> <span class="fl">305</span>, lastdays <span class="op">=</span> <span class="fl">180</span>, yearback <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#daily.relation.res %&gt;% left_join(calendar)</span></span>
<span><span class="co">#You can also have a small fancy plot </span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_daily_relation.html">plot_daily_relation</a></span><span class="op">(</span></span>
<span>  <span class="va">daily.relation.res</span>,</span>
<span>  <span class="va">calendar</span>,</span>
<span>  x_axis <span class="op">=</span> <span class="st">"reversed.day"</span>, <span class="co">#can change to doy or reversed.day</span></span>
<span>  whattoplot <span class="op">=</span> <span class="st">"estimate"</span>,</span>
<span>  highlight_window <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">160</span>, <span class="fl">150</span><span class="op">)</span>,<span class="co">#here it is close, but remember it is a simulation...</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="weatheRcues_files/figure-html/run%20daily%20models-1.png" width="700"></p>
<p>And now let’s try the climate sensitivity profile.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#here it is CSP method</span></span>
<span><span class="va">csp.out</span> <span class="op">=</span> <span class="fu"><a href="../reference/runing_csp.html">runing_csp</a></span><span class="op">(</span>Results_days <span class="op">=</span><span class="va">daily.relation.res</span>,</span>
<span>           bio_data <span class="op">=</span> <span class="va">seed_production_simulated</span>,</span>
<span>           climate_data<span class="op">=</span> <span class="va">climate_data_simulated</span>,</span>
<span>           siteneame.forsub <span class="op">=</span> <span class="st">"test"</span>,</span>
<span>           refday <span class="op">=</span> <span class="fl">305</span>,</span>
<span>           lastdays <span class="op">=</span> <span class="fl">170</span>,</span>
<span>           rollwin <span class="op">=</span> <span class="fl">1</span>, yearneed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>           k.provided <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, <span class="co">#by default please keep na, here is just a test to make it fast</span></span>
<span>           formula_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="st">'log.seed ~ temp'</span><span class="op">)</span>, optim.k <span class="op">=</span> <span class="cn">F</span>, option.check.name <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">csp.out</span></span>
<span><span class="co">#&gt;   sitenewname plotname.lon.lat reference.day windows.size window.open</span></span>
<span><span class="co">#&gt; 1        test             test             1            1         169</span></span>
<span><span class="co">#&gt; 2        test             test             1            1         159</span></span>
<span><span class="co">#&gt;   window.close intercept.estimate intercept.std.error slope.estimate</span></span>
<span><span class="co">#&gt; 1          164          1.0251390           0.5906223      0.6019482</span></span>
<span><span class="co">#&gt; 2          143          0.9289593           0.3380087     18.3943038</span></span>
<span><span class="co">#&gt;   slope.std.error       pvalue         r2      AIC    sigma nobs nsequence.id</span></span>
<span><span class="co">#&gt; 1        1.639869 7.145602e-01 0.00172447 495.9582 5.238101   80            1</span></span>
<span><span class="co">#&gt; 2        1.469821 2.439479e-20 0.66754269 407.9968 3.022850   80            2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="peak-detection-method">Peak detection method<a class="anchor" aria-label="anchor" href="#peak-detection-method"></a>
</h2>
<p>Peak signal detection identifies days with highest
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>×</mo></mrow><annotation encoding="application/x-tex">R^2 \times</annotation></semantics></math>
slope signal strength. It is quick method, but might be sensitive if you
have multiple peaks (i.e multiple windows can be detected). It will work
like a moving window after runing correlation to each days. Here you can
adjust parameters lag, that will basically search cues after a number of
lag day (here we specified 50). Then by increasing the threshold, you
will basically select only the highest peak of correlation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak.out</span> <span class="op">=</span> <span class="fu"><a href="../reference/runing_peak_detection.html">runing_peak_detection</a></span><span class="op">(</span>Results_days <span class="op">=</span> <span class="va">daily.relation.res</span>,</span>
<span>           bio_data <span class="op">=</span> <span class="va">seed_production_simulated</span>,</span>
<span>           climate_data <span class="op">=</span> <span class="va">climate_data_simulated</span>,</span>
<span>           refday <span class="op">=</span> <span class="fl">305</span>,</span>
<span>           lastdays <span class="op">=</span> <span class="fl">170</span>,</span>
<span>           rollwin <span class="op">=</span> <span class="fl">1</span>, yearneed <span class="op">=</span> <span class="fl">1</span>,formula_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="st">'log.seed ~ temp'</span><span class="op">)</span>,</span>
<span>           lag <span class="op">=</span> <span class="fl">50</span>,</span>
<span>           threshold <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  tolerancedays <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">peak.out</span></span>
<span><span class="co">#&gt;   sitenewname plotname.lon.lat reference.day windows.size window.open</span></span>
<span><span class="co">#&gt; 1        test             test             1            1          51</span></span>
<span><span class="co">#&gt; 2        test             test             1            1          73</span></span>
<span><span class="co">#&gt; 3        test             test             1            1          91</span></span>
<span><span class="co">#&gt; 4        test             test             1            1         105</span></span>
<span><span class="co">#&gt; 5        test             test             1            1         125</span></span>
<span><span class="co">#&gt; 6        test             test             1            1         156</span></span>
<span><span class="co">#&gt; 7        test             test             1            1         169</span></span>
<span><span class="co">#&gt;   window.close intercept.estimate intercept.std.error slope.estimate</span></span>
<span><span class="co">#&gt; 1           51          0.7837830           0.5663751     -1.5158707</span></span>
<span><span class="co">#&gt; 2           73          0.6724786           0.5817803     -1.2563666</span></span>
<span><span class="co">#&gt; 3           91          0.9399305           0.5657726      1.3444472</span></span>
<span><span class="co">#&gt; 4          105          0.8785059           0.5688615      1.2959679</span></span>
<span><span class="co">#&gt; 5          125          1.0400171           0.5667397      1.2974821</span></span>
<span><span class="co">#&gt; 6          146          1.0516443           0.1616624     15.6839376</span></span>
<span><span class="co">#&gt; 7          167          0.9506381           0.5897548     -0.6348765</span></span>
<span><span class="co">#&gt;   slope.std.error       pvalue          r2      AIC    sigma nobs nsequence.id</span></span>
<span><span class="co">#&gt; 1       0.5643704 8.833531e-03 0.084660975 489.0194 5.015794   80            1</span></span>
<span><span class="co">#&gt; 2       0.5250706 1.912750e-02 0.068381823 490.4297 5.060199   80            2</span></span>
<span><span class="co">#&gt; 3       0.5552178 1.777984e-02 0.069917768 490.2977 5.056026   80            3</span></span>
<span><span class="co">#&gt; 4       0.5539512 2.186933e-02 0.065568940 490.6709 5.067833   80            4</span></span>
<span><span class="co">#&gt; 5       0.5522725 2.133722e-02 0.066085823 490.6266 5.066431   80            5</span></span>
<span><span class="co">#&gt; 6       0.5095246 2.169725e-45 0.923939664 289.9980 1.445865   80            6</span></span>
<span><span class="co">#&gt; 7       1.0473750 5.461688e-01 0.004688548 495.7203 5.230319   80            7</span></span></code></pre></div>
<p>Again, if you arrived here, these methods are available thanks to all
previous research done on this topic (i.e detecting environmental cues),
and we tried to make some of these methods more accessible to a broader
audience. But we have still some improvement to make and would be happy
to hear other advice ;)</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Valentin Journé.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
